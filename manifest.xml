<?xml version="1.0" encoding="UTF-8"?>
<OfficeApp
    xmlns="http://schemas.microsoft.com/office/appforoffice/1.1"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"
    xmlns:mailappor="http://schemas.microsoft.com/office/mailappversionoverrides/1.0"
    xsi:type="MailApp">

  <Id>8d69d9d2-1cb9-4122-869d-97974d007d97</Id>
  <Version>5.0.0.0</Version>
  <ProviderName>Domain Guard</ProviderName>
  <DefaultLocale>en-US</DefaultLocale>
  <DisplayName DefaultValue="Recipient Domain Guard"/>
  <Description DefaultValue="Warns when emailing multiple external domains."/>

  <IconUrl DefaultValue="https://labrodim.github.io/domain-guard/icon-32.png"/>
  <HighResolutionIconUrl DefaultValue="https://labrodim.github.io/domain-guard/icon-80.png"/>
  <SupportUrl DefaultValue="https://metaformalabs.sharepoint.com"/>

  <Hosts>
    <Host Name="Mailbox"/>
  </Hosts>

  <Requirements>
    <Sets DefaultMinVersion="1.8">
      <Set Name="Mailbox"/>
    </Sets>
  </Requirements>

  <FormSettings>
    <Form xsi:type="ItemEdit">
      <DesktopSettings>
        <SourceLocation DefaultValue="https://labrodim.github.io/domain-guard/commands.html"/>
      </DesktopSettings>
    </Form>
  </FormSettings>

  <Permissions>ReadWriteItem</Permissions>

  <Rule xsi:type="RuleCollection" Mode="Or">
    <Rule xsi:type="ItemIs" ItemType="Message" FormType="Edit"/>
  </Rule>

  <VersionOverrides xsi:type="mailappor:MailAppVersionOverrides" Version="1.0">

    <mailappor:FormSettings>
      <mailappor:Form xsi:type="mailappor:ItemEdit">
        <mailappor:DesktopSettings>
          <mailappor:SourceLocation resid="functionFile"/>
        </mailappor:DesktopSettings>
      </mailappor:Form>
    </mailappor:FormSettings>

    <mailappor:Hosts>
      <mailappor:Host xsi:type="mailappor:Mailbox">
        <mailappor:DesktopFormFactor>

          <mailappor:FunctionFile resid="functionFile"/>

          <mailappor:ExtensionPoint xsi:type="mailappor:MessageSendCommandSurface">
            <mailappor:OfficeTab id="TabDefault">
              <mailappor:Group id="msgSendGroup">
                <mailappor:Label resid="groupLabel"/>
                <mailappor:Control xsi:type="mailappor:Button" id="msgSendButton">
                  <mailappor:Label resid="buttonLabel"/>
                  <mailappor:Action xsi:type="mailappor:ExecuteFunction">
                    <mailappor:FunctionName>onItemSend</mailappor:FunctionName>
                  </mailappor:Action>
                </mailappor:Control>
              </mailappor:Group>
            </mailappor:OfficeTab>
          </mailappor:ExtensionPoint>

        </mailappor:DesktopFormFactor>
      </mailappor:Host>
    </mailappor:Hosts>

    <mailappor:Resources>
      <mailappor:bt:Urls>
        <mailappor:bt:Url id="functionFile"
          DefaultValue="https://labrodim.github.io/domain-guard/commands.html"/>
      </mailappor:bt:Urls>

      <mailappor:bt:ShortStrings>
        <mailappor:bt:String id="groupLabel" DefaultValue="Domain Guard"/>
        <mailappor:bt:String id="buttonLabel" DefaultValue="Check Recipients"/>
      </mailappor:bt:ShortStrings>

    </mailappor:Resources>
  </VersionOverrides>

</OfficeApp>
